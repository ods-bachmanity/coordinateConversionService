# Coordinate Conversion Service - Newman Postman Collection Test Configuration

## Introduction

The purpose of the integration tests for Coordinate Conversion Service is to check what the service returns against what is expected. The configuration file is loaded into the test file to check the API calls. Each test generates a report which shows the passing or failing of the tests. If the tests pass, the report returns positive. If the tests fail, the report states which test failed and why.

# Newman Jenkins API Testing

For more information on Newman CLI integration , checkout the [Newman Command Line Integration](https://www.getpostman.com/docs/v6/postman/collection_runs/command_line_integration_with_newman).

For more information on Newman Postman API testing , checkout the [Postman Sandbox API Reference](https://www.getpostman.com/docs/v6/postman/scripts/postman_sandbox_api_reference).

# Postman Collection JSON - Test File

At it's core, Newman executes a collection JSON that can either be generated by Postman's GUI or manually created JSON files that follow the same structure. In this collection, users can define global variables , pre-request scripts, and API calls to be executed in support of analyzing response JSON and other micro-service behavior.


# Configuration File JSON

Though the collection JSON can house all our tests and unique configurations, doing so would result in a massive file that is difficult to maintain. However, to add flexibility to your test environment Newman provides an option to specify a configuration JSON file as a flag during CLI execution. With this reference, users can specify hosts, desired request bodies, and define the expected response from the API call for any given request.

# Happy Path Test

Tests all positive API calls to the Coordinate Conversion Service.

Health Check
 - Valid 200 Response

/datums
 - Valid 200 Response
 - Check number of availableDatums - 253 responses
 - Match all available Datums coordinates
 - Check 4th, 100th, & 250th items

/coordinateTypes
 - Valid 200 Response
 - Check number of availableCoordinateTypeNames – 39 responses
 - Match all availableCoordinateTypeNames
 - Check 4th, 25th, 37th items

/ellipsoids
 - Valid 200 Response
 - Check number of availableEllipsoids – 25 responses
 - Match all availableEllipsoids
 - Check 4th, 15th, 24th items

/sourceCoordinateInputByType
 - Valid 200 Response
 - Check number of requiredSourceCoordinateFieldsByType – 15 responses
 - Match all requiredSourceCoordinateFieldsByType
 - Check 3 coordinate types 

/doTranslation (2) 
 - Valid 200 Response
 - Match expected coordinate string

/doConversion 
 - Valid 200 Response
 - Match expected coordinates

 Test Report 
┌─────────────────────────┬──────────┬──────────┐
│                         │ executed │   failed │
├─────────────────────────┼──────────┼──────────┤
│              iterations │        1 │        0 │
├─────────────────────────┼──────────┼──────────┤
│                requests │        8 │        0 │
├─────────────────────────┼──────────┼──────────┤
│            test-scripts │        8 │        0 │
├─────────────────────────┼──────────┼──────────┤
│      prerequest-scripts │        8 │        0 │
├─────────────────────────┼──────────┼──────────┤
│              assertions │       32 │        0 │
├─────────────────────────┴──────────┴──────────┤
│ total run duration: 944ms                     │
├───────────────────────────────────────────────┤
│ total data received: 20.05KB (approx)         │
├───────────────────────────────────────────────┤
│ average response time: 60ms                   │
└───────────────────────────────────────────────┘


#Bad Path Test

Tests all expected errors with bad API calls to the Geospatial Conditioning Service.

Bad Path Tests:
Unknown Endpoint
 - 404 Error 
 - Expected status, error and message
Invalid Path
 - 404 Error
 - Expected status, error and message
Request method 'POST' not supported
 - 405 Error
 - Expected status, error and message
doTranslation – invalid inputCoordinateString
 - 500 Error
 - Expected response
doTranslation – invalid inputCoordinateType
 - 500 Error
 - Expected response
doTranslation – invalid inputCoordinateType (must be numeric)
 - 500 Error
 - Expected response
 doTranslation - empty JSON body
 - 500 Error
 - Expected response
doConversion – missing parameter [sourceDatum, sourceLatitude, targetCoordinateType]
 - 500 Error
 - Expected response
 doConversion – empty JSON body
 - 500 Error
 - Expected response


Test Report
┌─────────────────────────┬──────────┬──────────┐
│                         │ executed │   failed │
├─────────────────────────┼──────────┼──────────┤
│              iterations │        1 │        0 │
├─────────────────────────┼──────────┼──────────┤
│                requests │        9 │        0 │
├─────────────────────────┼──────────┼──────────┤
│            test-scripts │        9 │        0 │
├─────────────────────────┼──────────┼──────────┤
│      prerequest-scripts │        9 │        0 │
├─────────────────────────┼──────────┼──────────┤
│              assertions │       17 │        0 │
├─────────────────────────┴──────────┴──────────┤
│ total run duration: 1319ms                    │
├───────────────────────────────────────────────┤
│ total data received: 984B (approx)            │
├───────────────────────────────────────────────┤
│ average response time: 114ms                  │
└───────────────────────────────────────────────┘


# Execution Commands

Happy Path Tests:
newman run CCS_happy_path_test.json -d CCS_happy_path_config.json

Bad Path Tests:
newman run CCS_bad_path_test.json -d CCS_bad_path_config.json